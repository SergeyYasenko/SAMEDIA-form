(()=>{"use strict";const e=document.querySelector(".preloader"),r=(document.querySelector(".form__title"),document.querySelectorAll(".form__input")),t=document.querySelector(".form__button"),o=(document.querySelector(".form__form"),".form__field"),l=o=>{o?e.classList.add("preloader_opened"):e.classList.remove("preloader_opened"),t.disabled=o,r.forEach((e=>{e.disabled=o}))},s=new class{constructor({url:e}){this.url=e}async _requestResult(e){const r=await e.json();if(!e.ok)throw new Error(r.message);return r}async login(e){const r=await fetch(`${this.url}index.php?login=${e.email}&password=${e.password}`);return this._requestResult(r)}}({url:"https://test-works.pr-uni.ru/api/login/"}),n=document.querySelector("#name"),d=document.querySelector("#password"),a=document.querySelectorAll(".form__field");document.querySelector(".section__form").addEventListener("submit",(async e=>{e.preventDefault();let r=0;if(a.forEach((e=>{e.classList.remove("form__field_error")})),(""===n.value.trim()||n.value.length<3)&&(r++,a.forEach((e=>{e.classList.add("form__field_error")}))),d.value.length<6&&(r++,a.forEach((e=>{e.classList.add("form__field_error")}))),0===r)try{l(!0),"ok"===(await s.login({email:n.value,password:d.value})).status?(n.value,document.querySelectorAll(o).forEach((e=>{e.style.borderColor="#43A470",e.addEventListener("input",(()=>{e.style.borderColor="#F65454",e.style.color="#F65454"}))}))):(document.getElementById("error").innerText="Неправильный логин или пароль",a.forEach((e=>{e.classList.add("form__field_error")})))}catch(e){document.getElementById("error").innerText="Неправильный логин или пароль",a.forEach((e=>{e.classList.add("form__field_error")}))}finally{l(!1)}else document.getElementById("error").innerText="Неправильный логин или пароль",a.forEach((e=>{e.classList.add("form__field_error")}))})),n.addEventListener("input",(()=>{document.getElementById("error").innerText="",a.forEach((e=>{e.classList.remove("form__field_error")}))})),d.addEventListener("input",(()=>{document.getElementById("error").innerText="",a.forEach((e=>{e.classList.remove("form__field_error")}))}))})();